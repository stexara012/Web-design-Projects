<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASCII Warp Flight: Final Jump</title>
<style>
  body {
    margin: 0;
    background: black;
    overflow: hidden;
    font-family: Consolas, monospace;
    color: cyan;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>

<!-- ASCII brod -->
<pre id="ascii-ship" style="
  display:none;
  font-size:4px;
  line-height:0.6;
  transform-origin:center;
  transform:translate(-50%, -50%) scale(0.2);
  position:absolute;
  white-space:pre;
  color:cyan;
  left:50%;
  top:60%;
">
                                                                                                                                          
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
   -                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                     - ----        -                                                                                                                                        
                                                                                                                                                                                                                                                                                                            
                                                                                                                                            - -----    - --- ---- --                                                                                                                                        
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                     -                                                                                                  
                                                                                                     -                                                                                                  
                                                                                             ------  ---------                                                                                          
                                                                                            -       ---                                                                                                 
                                                                                           ----------   ------                                                                                          
                                                                                       +  -                   . .                                                                                       
                                                                                         . @@@@@@@@@@@@@@@@@@ :                                                                                         
                                                                                           @@@@@@@@@@@@@@@@@@                                                                                           
                                                                                       @   @@@@@@@@@@@@@@@@@@   @                                                                                       
                                                                                       @@@@##: -:.:...::: :+#@@@@     -                                                                                 
                                                                         : -.  .-      @@@@%###%#####*###*%#+@%@@      -  -    -                                                                        
                                                                              .    @@@@.**#*+#*:##**##+*##:*+#**:@@@@:                                                                                  
                                                                         .  - -    @#@@+@@@--:*#####*###:@. .@%@*@@@@      -                                                                            
                                                                            -   @@@**-+.##-@@%*#+*####*##*@@@--*.#:: @@@  .    -                                                                        
                                                                         . -     @@#@%@**#.@@@  %###*#.%- @@@ #**@@%#@@    --  -                                                                        
                                                                         -- . @@@-#-:.+####. #@@:####+#.@@* -###*+.#.+*@@@ - .                                                                          
                                                                         .    @@@@#*######*#.#@@ :  . * @@@-#%###*+####@@@     .                                                                        
                                                                          - @@.@*:####*##*###*-:@@@@@@@@*:**##%##+%::+*.@-@@                                                                            
                                                                            @@@*#+**##*##*##*.-+@@@@%@@@+ -##@:#######-##*@@                                                                            
                                                                  ---   @@@+@#######***####:*#@@@@@@@@@@@#*#+##***#*######@-@@@ --: .. -                                                               
                                                                    -   @@@@ @.*+*####*##### *@@@@@@@@@@@@*:##*########*:.@-@@@@    .-  -                                                               
                                                                        @@@@##+#*%########**#:%@@@@@@@@@@+-.+##########*#%.@@*@     -  -                                                               
                                                                 -   -@@-#:@ *+#*#########.@@@:+@@@@@@@.+@@@ ###########** %.:.@@   -  -                                                               
                                                                --    @@:#%######*####*###.@@*##@@@@@@@@###@@:##############%%%#@@    :                                                                 
                                                                -  @@@-*+.+:*####*########-@@*##-.@@@@ *##+@@-#############*+.::. @@@  -   .                                                            
                                                                   @@@ *-::++#########*#*#-@@+-*#%@@%@*#+::@@ #########*###+*.::: @@@        .                                                          
                                                             @@@@@@+  @@#@@@**############.@@@@@##: -:**@@@@@-#############*@@@#@@   @@@@@@                                                             
                                                             @@@@@@# @@@**+#-.*###*##*####-@@@@@.######-@@@@@ #########**#:-#+#:@@+-:@@@@@@                                                             
                                 ---   - ---  --- .-. @@@@@@@ --------- @@@@*##**##+%***#*#*:-.-@@-##.@@:+--.##***%+###+@.@#@@@@-- --------@@@@@@@ - ---------  - -  ---                                
                                     .        --      @@@@@@@ *#-:**-: .@@@@.::#*:..######**-* *@@:##.@@ :*.:#######.-.*#:# @@@@- +-+*+:.# @@@@@@@        . ---  ----                                   
                                       -.----   @@@@@@ -    - ---::--:#  -  @@###@@#%-+#*#+@@@@@+#*##*#:%@@@@-##*#+##%#@#:@@ ------:-.---+-:  -- *@@@@@@   .    ----                                    
                                     -          @@@@@@ -::.::.-.:--:+-#- -- @@@###+##-#+:* @@@@#-##@*##.@@@@@ #++:-####*#+@@ .---*-:....-.--*.#---@@@@@@           -                                    
                             -     - - @#:.:.:. @@*@*@.-:::+*-:+-.+:-+:.:.. @%@*##%@%.##+#*@@@#@##%%@#*##@*%@.#*##-@@%##%##@ --:%-*.:.:.:-:#.+.%--@####@ -+::::#@       -                               
                           .           @@@@@@@@@ -----------.+++.:.::..:.:.:  @@@@@@@:%#+@@.+#####%###%#*-##:@@.## @@@@@@@ -++:..:.:.:.:-*:-------.---- @@@@@@@@@        + -                            
                                 :     @@@@@@@@@ *+*+#.:::..-..::.::::::::--: @@@@@@%#:**@@:*#########%*#@:**@@-##@@@@@@@@ #:....:::..:..++::..::+#*+*: @@@@@@@@@     -                                 
                             -   @@@@@@ -----------  ........:::::..:.:..*++:.  --   @@@@@@########%#####+###@@@@@@  -----....:+:.::::::+:+..:...+---------- --  @@@@@@   + -                           
                            :    @@@@@@-*####%##:.:..-:::....:::.:....:.++...:-#:+-- @@@@@@#*.*#-.##..--+#+:#@@@@@@ ::+.#+*.::.::....:.:.++++::::+:::::-#######*-@@@@@@                                 
                    -    -.-. @@@ -      -------...:::.:.::::::.:.::::..:::::::.:.+:-      @@@@@@@@@@@@@@@@@@      -.:::.:.::::::::::::.:.:....::.:.....---------- - - @@@  .  -                        
                    -  .   .  @@@-*###%::.........::::..:::::....::.:::::::.::...:..+**#:%-@@@@@@@@@@@@@@@@@@ :+++:...::......::::::::::.:.........::::.......:..%###*-@@:   . -                        
                         +  @@. -.----.-......:::::::::::::::::::::::::::::::::::.::.--.-+-            -     ......:::::::::::::::::::::::::::::::::::::.....:::-:------ @@@  -  .                      
                      - .   @@#-# ::-......:::..::::::::::::::::::::::::::::::::::.::::.::..-:-----  -  -.---.....:::::::::::::::::::::::::::::::::::::.::.:....:.-:.--#:@@@                            
                      -   @@  ..--+-+.-::.:++:::...::::::::::::::::::::::::::::::.:.:..-+-+.-+--@@@@@@%@+-::-::::::.::::::::::::::::::::::::::::::::::....::..:...:..+...-  @@                          
                      --  @@---    :-----::.+..:..:.::::::::::::::::::::::::::::::.:::.:.::+@- -@@@@@%@@  --*+.....:::::::::::::::::::::::::::::::..:..+:::.++  ----.  ---- @@                          
                  -     @@  @@@@@@@-***+*:-...:.::.:::::::::::::::::::::::::::::::..:::.::.--+@# ------ #@#---::::::::::::::::::::::::::::::::::::.:.:.:-.:..--%*###-@@@@@@@##@@                        
                  -     @@  @@@@@@@ -------:----...::::::::::::::::::::::::::::::.::....:.-- *@@ .-  -- @@# -+::::::::::::::::::::::::::::::::::::.:.:....---------- @@@@@@@  @@                        
                  -     @@  @@%#@%#@.+:+@  +:+.+-.::+..::....::::::::::::::......:...::.:--: @@@ -%--@--@%%## :...:..:::::.....:........:.....::::...::....--  @::..-@@##@@##*@@                        
                        @@ .-   -  @@@@@@+--..*#--::-.*..::*:-:+...........::::::.:++-.*.:-@@% .- @%#@ +- :@@ :+*#.::.:....::::.::::::::.::::+..-+.:...--#-:*- @@@@@@  -.:-+# @@                        
                    -   @@ --- --- @@@@@@ -  - % :--.:-...:.:+.-:::::::::..:::::..::::.: * %@@-.. #### -+-@@% +-.-:.......::::..........-::::.-:-:.---- %  --  @@@@@@:#+##+## @@                        
                    -   @@ -- @@@ .    - @@@@@@@ #*+#*#-...-...+-.........::::::::.:.::+ @@   -.@%#::-%@-:-  @@ +#...:+.::....:...........--..#-+*#+**# @@@@@@@ --  --+@@#:*# @@                        
                        @@ -- ### :+ ----@@@@@@@  -  - .-  ---.:-........::.....:.:....- @@.--- #*:.+:+#  -.-@@  #::::+::::.....::::::.::-------- -     @@@@@@@.+++*+%:@##.##-@@                        
                        @@ ---%@# -- @@--       @@@@@@.:####+#@-.::::::::.:.....:::+:. @@ -.-@@#****-@-*#@%--  @@ -....::...:::.........-@#####* @@@@@@@      -*.@@:+# @@#.## @@                        
                        @@  --@@@ #- @@ -+----- @@@@@@ ---- ---------------*::..:-:+-- @@ -+ #@%#%%%@%@%###--: @@ -.+..:.....--.-----: --------- -@@@@@@ #*:*#*+ @@-####@%-#+ @@      -                 
                  -       @@ -- ---: @#--+ @@@--  --  @@@@@@@@@-+########@--:-:::::--@@  -+:..------- -- -:.::-- @@. .*:::.+-+#########%-@@@@@@@@@ ------.@@@.:+-@@.*#*+-.%.@@   :    -                 
                          @@  - -  : @@-.+-.@@-+-.----@@@@@@@@@ ---------  :------:- @@ -            -  ----   - @@:-:.------   ----- - -@@@@@@@@@ .- ++# %@+-#*+@@-:: * * #@@        -                 
                  -  -- .   @@@@@@@ ---++..*#@ #- @@ --     -  @@@@@@@@@@@-+#%+%*.+- @#@@@@@@@@@@@@@@@@@@@@@@@@@@ --..*###**#-@@@@@@@@@@@      - -:+@@.#+-@@%.*+.*#--@@@@@@@   .-     -                 
                            @@@@@@@  -   - @@@ :. @@ ---- ---- @@@@@@@@@@@ --------  @@%@@@@@@@@@@@@@@@@@@@@@@@#@ -:- - ----- @@@@@@@@@@@ *.:- -#.:-@@ ++-@@#++    . @@@@@@@                            
                            **   --@@@@@@---:+--: @@--..+@%--# #    --   .@@@%@@+.:+-%.:::::::::::::::::::..:.*-% #+ @@@@@@@@@-..--..--:%-*:-%%*::.-@@ %::*###-@@@@@@     -@                            
                           :       @@@@@@- -- - - @@ -+-#@@--.#---------- @@@@@@@ ---------------------------------- @@@@@@@@@ .-.- ----+*:+ @@#-*..@@ #-: -- -@@@@@@       .                           
                            *      @@@@@@.----.@- @@ - -*%@ :-.-+--*#*--+-@@*@%@#+#::..+++::..:.:::::.....::::*.-..::@@@@@%@@@ #--:++-*.::+* @@*-*:+@%--*+.##+@.@@@@@     -                             
                           - - --        @@@@@@@ - ----:-@@ .:%-*: @@@ .*-  --- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  ------ *:# @@@ +.*.#. @@+ -*.- + @@@@@@@       +    -                            
                                     -   @@@@@@@ -------:@@-.--:::-@@*-+.+------@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+--+ -:-*:++ #@# #+**++-%@%-*----  @@@@@@@ ---.-                                   
                               ----             @@@@@@ ----*-:. +- *@* -+.: @@.--                              --  - -:*- @@ .++# %@@ +*.#:#+----#@@@@@@       -                                        
                                   -       : -  @@@@@@         -.- @@@ +-:+ @# -.#::::::+:+:::.:---  --#.:.:.+**++#+++-.: @# #:.* @@@ :*.        *@@@@@@  - .- -                                        
                            -          ---    -       @@@@@@@@@-------:-..- @@--+-:....:....:..---@@@@ -.:.:+:.:::+-+:#+- @@-.-+*:---*.*-@@@@@@@@@        --                                            
                            -          --   . -   -   @@@@@@@@@          ---@@- :-:..:.::.:+.:--  @@@@   :::++.:++-#-#:.--@@-.-          @@@@@@@@@       -    --                                        
                                                               @@@@@@@@@@@-.-  -:+:.::::::.+-*--@@    @@*-..:+++:.:::.:.@---: @@@@@@@@@@@                                                               
                                                    - *        @@@@@@@@@@@  --- -%-:........:. *@@ -- @@--::..::::::::.-    - @@@@@@@@@@@       *                                                       
                                                  .          .            @@@@@@%-+++++++++*+:+.- @@%@ - +++**.::::+++-@@@@@@@          .                                                               
                                                   .  .                   @@@@@@@ --.-....--:-+:- @%@@--+...:::++*#**- #@@@@@@                                                                          
                                                                          @..+% #@#-..-::::::+::.+:.**.....:+:::::-: @@% #-#*@  ----- - -                                                               
                                                                         +      @@@ ----------------- -------------- @@@      .-                                                                        
                                                                                @@*:.  -      --:--::.  - -   .---.--%@@       ----------                                                               
                                                                          ---      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   -  :   -                                                                        
                                                                         . ---- - .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   : ---  .---------                                                               
                                                                                                                                                               
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                                                                                        
                                                                                                                                         
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            

</pre>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let WIDTH = window.innerWidth;
let HEIGHT = window.innerHeight;
canvas.width = WIDTH;
canvas.height = HEIGHT;

// ASCII brod
const originalShip = document.getElementById("ascii-ship")
    .innerText
    .split("\n")
    .filter(line => line.trim() !== "");

// parametri
const scale = 0.5;
const fontSize = 6;
const lineHeight = 0.8;

let shipX = WIDTH/2 - 40;
let shipY = HEIGHT - 150;
let speed = 5;
let warpSpeed = 0.004;
let tilt = 0;
let energy = 100;

// warp stars
let stars = [];
for (let i = 0; i < 400; i++) {
    let angle = Math.random() * Math.PI*2;
    let radius = Math.random() * (WIDTH/2);
    let depth = Math.random() * 0.8 + 0.2;
    stars.push({angle, radius, depth});
}

let rotation = 0;
let rollAngle = 0;
let keys = {};

window.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
window.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

function drawText(text, x, y, color="cyan", size=fontSize) {
    ctx.fillStyle = color;
    ctx.font = `${size}px Consolas`;
    ctx.fillText(text, x, y);
}

function loop() {
    ctx.fillStyle = "rgba(0,0,0,0.25)";
    ctx.fillRect(0,0,WIDTH,HEIGHT);

    // kontrole
    let boost = false;
    if (keys["shift"]) {
        warpSpeed = 0.009;
        boost = true;
        energy = Math.max(0, energy - 0.5);
    } else {
        warpSpeed = 0.004;
        energy = Math.min(100, energy + 0.1);
    }

    if (keys["arrowup"]) shipY -= speed;
    if (keys["arrowdown"]) shipY += speed;
    if (keys["arrowleft"]) {
        shipX -= speed;
        tilt -= 0.25;
    } else if (keys["arrowright"]) {
        shipX += speed;
        tilt += 0.25;
    } else {
        if (tilt>0) tilt -= 0.15;
        else if (tilt<0) tilt += 0.15;
    }

    tilt = Math.max(-5, Math.min(5, tilt));
    rollAngle = -tilt*1.8;
    shipX = Math.max(0, Math.min(WIDTH-100, shipX));
    shipY = Math.max(0, Math.min(HEIGHT-50, shipY));

    ctx.save();

    // warp stars
    rotation += 0.01;
    for (let s of stars) {
        s.depth -= warpSpeed;
        if(s.depth <= 0){
            s.depth = 1;
            s.radius = Math.random() * (WIDTH/2);
            s.angle = Math.random()*Math.PI*2;
        }
        s.angle += rotation*0.05;

        let x = WIDTH/2 + Math.cos(s.angle)*s.radius/s.depth;
        let y = HEIGHT/2 + Math.sin(s.angle)*s.radius/s.depth;

        let colorIntensity = Math.max(50, Math.min(255, (1-s.depth)*255));
        ctx.strokeStyle = `rgb(${colorIntensity/2},${colorIntensity},255)`;
        ctx.fillStyle = ctx.strokeStyle;

        if(boost){
            let ex = WIDTH/2 + Math.cos(s.angle)*s.radius/(s.depth+0.1);
            let ey = HEIGHT/2 + Math.sin(s.angle)*s.radius/(s.depth+0.1);
            ctx.lineWidth=2;
            ctx.beginPath();
            ctx.moveTo(ex, ey);
            ctx.lineTo(x, y);
            ctx.stroke();
        } else {
            ctx.fillRect(x,y,2,2);
        }
    }

    // trag motora
    for(let t=0;t<5;t++){
        let fade = 255 - t*50;
        ctx.fillStyle = `rgba(0,${fade},${fade},1)`;
        ctx.beginPath();
        ctx.arc(shipX+20, shipY+80+t*4, 4-t, 0, Math.PI*2);
        ctx.fill();
    }

    // ASCII brod sa +180 rotacijom
    const shipWidth = Math.max(...originalShip.map(l=>l.length))*fontSize*scale;
    const shipHeight = originalShip.length*fontSize*lineHeight*scale;

    ctx.save();
    ctx.translate(shipX + shipWidth/2, shipY + shipHeight/2);
    ctx.rotate(Math.PI-Math.pi); // +180
    ctx.translate(-shipWidth/2, -shipHeight/2);

    for(let i=0;i<originalShip.length;i++){
        let offsetX = Math.sin(i*0.3)*tilt*1.5;
        drawText(originalShip[i], offsetX, i*fontSize*lineHeight*scale, "cyan", fontSize*scale);
    }
    ctx.restore();

    // HUD
    ctx.fillStyle="rgb(0,255,200)";
    drawText(`COORD: X=${Math.floor(shipX)}  Y=${Math.floor(shipY)}`,20,30);
    drawText(`WARP: ${boost ? "BOOST":"NORMAL"}`,20,55);
    drawText(`ENERGY: ${Math.floor(energy)}%`,20,80);
    drawText(`TILT: ${tilt.toFixed(1)}`,20,105);

    // energy bar
    ctx.strokeStyle="rgb(0,100,0)";
    ctx.strokeRect(20,120,200,10);
    ctx.fillStyle="rgb(50,255,50)";
    ctx.fillRect(20,120,energy*2,10);

    ctx.restore();

    requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
