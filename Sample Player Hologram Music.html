<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hologram Pyramid Music Player</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* ==============================
   HOLOGRAM GRID + STARFIELD
============================== */
body {
  margin: 0;
  font-family: Arial, sans-serif;
  overflow: hidden;
  background: #000;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  perspective: 1200px;
}
body::before {
  content: "";
  position: fixed; top:0; left:0; width:100vw; height:100vh;
  z-index:-2;
  background:
    linear-gradient(rgba(0,255,255,0.12) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,255,255,0.12) 1px, transparent 1px),
    radial-gradient(circle at center, #111 0%, #000 90%);
  background-size: 50px 50px,50px 50px,100% 100%;
  animation: gridMove 12s linear infinite;
  filter: drop-shadow(0 0 5px #00ffff);
}
@keyframes gridMove {0%{background-position:0 0,0 0,0 0}100%{background-position:0 50px,50px 0,0 0}}

/* Starfield */
canvas#starfield {position:fixed; top:0; left:0; z-index:-3; display:block;}

/* ==============================
   PLAYER BOX (GLASS + RGB GLOW)
============================== */
.player-box {
  width: 780px;
  padding: 25px;
  border-radius: 25px;
  background: rgba(0,0,0,0.45);
  border: 2px solid #00fff0;
  animation: glowRGB 6s infinite linear;
  display:flex; flex-direction:column; align-items:center;
  box-shadow: 0 0 20px rgba(0,255,255,0.5);
  position: relative;
  z-index:2;
}
@keyframes glowRGB {
  0%{box-shadow:0 0 20px #00fff0; border-color:#00fff0;}
  33%{box-shadow:0 0 25px #00b3ff; border-color:#00b3ff;}
  66%{box-shadow:0 0 25px #ff00ff; border-color:#ff00ff;}
  100%{box-shadow:0 0 20px #00fff0; border-color:#00fff0;}
}

/* ==============================
   BUTTONS (GLASS, ROUND)
============================== */
.controls {
  display:grid;
  grid-template-columns: repeat(5, 1fr);
  gap:15px;
  margin:20px 0;
}

.btn {
  width:65px; height:65px;
  border-radius:50%;
  background: rgba(0,255,255,0.1);
  border:2px solid #00fff0;
  display:flex; justify-content:center; align-items:center;
  color:#fff; font-size:22px;
  cursor:pointer; position:relative; overflow:hidden;
  transition: transform 0.2s, box-shadow 0.2s;
  backdrop-filter: blur(5px);
}
.btn:hover { transform: scale(1.1); box-shadow:0 0 15px #00fff0;}
.btn:active::after{
  content:""; position:absolute; width:200px;height:200px;
  background: rgba(0,255,255,0.2); border-radius:50%;
  left:50%;top:50%;transform:translate(-50%,-50%) scale(0);
  animation:ripple 0.6s ease-out;
}
@keyframes ripple { to{transform:translate(-50%,-50%) scale(3); opacity:0;} }

/* ==============================
   PROGRESS BAR
============================== */
.progress-container {width:100%; height:10px; background:#111; border-radius:8px; overflow:hidden; margin-bottom:12px;}
.progress {height:100%; width:0%; background:#00fff0;}

/* ==============================
   PLAYLIST
============================== */
.playlist {margin-top:15px; width:100%; max-height:200px; overflow-y:auto; border:2px solid #00fff0; padding:10px; border-radius:10px;}
.playlist div {padding:10px; margin-bottom:5px; border-radius:5px; cursor:pointer; background:rgba(255,255,255,0.05); transition:0.2s;}
.playlist div:hover{background:rgba(0,255,255,0.2);}
.playlist .active-track{background:rgba(0,255,255,0.4);}

/* ==============================
   CANVASES: PYRAMID + WAVEFORM
============================== */
canvas#pyramid, canvas#waveform {width:100%; height:300px; margin-top:20px; background:transparent;}

/* Circular waveform halo */
</style>
</head>
<body>

<canvas id="starfield"></canvas>

<div class="player-box">
  <input type="file" id="audio-upload" accept="audio/*" multiple>

  <div class="controls">
    <button class="btn" id="play"><i class="fas fa-play"></i></button>
    <button class="btn" id="pause"><i class="fas fa-pause"></i></button>
    <button class="btn" id="stop"><i class="fas fa-stop"></i></button>
    <button class="btn" id="rewind"><i class="fas fa-backward"></i></button>
    <button class="btn" id="forward"><i class="fas fa-forward"></i></button>
    <button class="btn" id="shuffle"><i class="fas fa-random"></i></button>
    <button class="btn" id="repeat"><i class="fas fa-redo"></i></button>
    <button class="btn" id="mute"><i class="fas fa-volume-mute"></i></button>
    <button class="btn" id="vol-min"><i class="fas fa-volume-off"></i></button>
    <button class="btn" id="vol-max"><i class="fas fa-volume-up"></i></button>
  </div>

  <div class="progress-container"><div class="progress" id="progress"></div></div>
  <div class="time" id="time">0:00 / 0:00</div>
  <div class="playlist" id="playlist"></div>

  <canvas id="pyramid"></canvas>
  <canvas id="waveform"></canvas>
</div>

<script>
/* ==============================
   AUDIO & PLAYLIST
============================== */
let audio = new Audio();
let playlist=[], currentIndex=0;
let audioCtx, src, analyser, dataArray;

const starCanvas=document.getElementById("starfield");
const sCtx=starCanvas.getContext("2d");
starCanvas.width=window.innerWidth;
starCanvas.height=window.innerHeight;

const pyramidCanvas=document.getElementById("pyramid");
const pCtx=pyramidCanvas.getContext("2d");
pyramidCanvas.width=pyramidCanvas.offsetWidth;
pyramidCanvas.height=pyramidCanvas.offsetHeight;

const waveCanvas=document.getElementById("waveform");
const wCtx=waveCanvas.getContext("2d");
waveCanvas.width=waveCanvas.offsetWidth;
waveCanvas.height=waveCanvas.offsetHeight;

const listBox=document.getElementById("playlist");
const upload=document.getElementById("audio-upload");
const progressBar=document.getElementById("progress");
const timeDisplay=document.getElementById("time");

/* MULTI FILE UPLOAD */
upload.addEventListener("change",(e)=>{
  playlist=[...e.target.files];
  renderPlaylist();
  loadTrack(0);
});

function renderPlaylist(){
  listBox.innerHTML="";
  playlist.forEach((file,i)=>{
    const div=document.createElement("div");
    div.textContent=file.name;
    div.onclick=()=>loadTrack(i);
    if(i===currentIndex) div.classList.add("active-track");
    listBox.appendChild(div);
  });
}

function loadTrack(i){
  currentIndex=i;
  renderPlaylist();
  const file=playlist[i];
  if(!file) return;
  audio.src=URL.createObjectURL(file);
  audio.volume=0;
  audio.play();
  let v=0;
  const fade=setInterval(()=>{v+=0.03; audio.volume=Math.min(1,v); if(v>=1) clearInterval(fade);},40);
  setupAudioCtx();
}

audio.onended=()=>{currentIndex=(currentIndex+1)%playlist.length; loadTrack(currentIndex);};

/* ==============================
   AUDIO CONTEXT + ANALYSER
============================== */
function setupAudioCtx(){
  if(audioCtx) audioCtx.close();
  audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  src=audioCtx.createMediaElementSource(audio);
  analyser=audioCtx.createAnalyser();
  analyser.fftSize=256;
  dataArray=new Uint8Array(analyser.frequencyBinCount);
  src.connect(analyser);
  analyser.connect(audioCtx.destination);
  drawPyramid();
  drawWaveform();
  drawStarfield();
}

/* ==============================
   CONTROLS
============================== */
document.getElementById("play").onclick=()=>{audio.play(); audioCtx.resume();};
document.getElementById("pause").onclick=()=>audio.pause();
document.getElementById("stop").onclick=()=>{audio.pause(); audio.currentTime=0;};
document.getElementById("rewind").onclick=()=>audio.currentTime=Math.max(0,audio.currentTime-5);
document.getElementById("forward").onclick=()=>audio.currentTime=Math.min(audio.duration,audio.currentTime+5);
document.getElementById("shuffle").onclick=()=>loadTrack(Math.floor(Math.random()*playlist.length));
document.getElementById("repeat").onclick=()=>audio.loop=!audio.loop;
document.getElementById("mute").onclick=()=>audio.muted=!audio.muted;
document.getElementById("vol-min").onclick=()=>audio.volume=0;
document.getElementById("vol-max").onclick=()=>audio.volume=1;

/* ==============================
   PROGRESS BAR
============================== */
audio.addEventListener("timeupdate",()=>{
  if(!audio.duration) return;
  progressBar.style.width=(audio.currentTime/audio.duration*100)+"%";
  timeDisplay.textContent=formatTime(audio.currentTime)+" / "+formatTime(audio.duration);
});
function formatTime(s){let m=Math.floor(s/60); let sec=Math.floor(s%60).toString().padStart(2,"0"); return `${m}:${sec}`;}

/* ==============================
   STARFIELD CANVAS
============================== */
let stars=[];
for(let i=0;i<200;i++){stars.push({x:Math.random()*starCanvas.width,y:Math.random()*starCanvas.height,z:Math.random()*100+1});}
function drawStarfield(){
  requestAnimationFrame(drawStarfield);
  sCtx.fillStyle="rgba(0,0,0,0.2)";
  sCtx.fillRect(0,0,starCanvas.width,starCanvas.height);
  stars.forEach(star=>{
    star.z-=0.5; if(star.z<1){star.x=Math.random()*starCanvas.width; star.y=Math.random()*starCanvas.height; star.z=100;}
    const k=500/star.z;
    const x=star.x*k+starCanvas.width/2;
    const y=star.y*k+starCanvas.height/2;
    const size=(1-star.z/100)*3;
    sCtx.fillStyle="#00ffff"; sCtx.fillRect(x,y,size,size);
  });
}

/* ==============================
   PYRAMID VISUALIZER (Temple of Sound)
============================== */
let pyramidRotation=0;
function drawPyramid(){
  requestAnimationFrame(drawPyramid);
  if(!analyser) return;
  analyser.getByteFrequencyData(dataArray);
  pCtx.clearRect(0,0,pyramidCanvas.width,pyramidCanvas.height);

  const cx=pyramidCanvas.width/2;
  const cy=pyramidCanvas.height/2+50;
  const size=80;
  pyramidRotation+=0.002;

  // Top point
  const top={x:cx, y:cy-size};
  const base=[
    {x:cx-size, y:cy+size},
    {x:cx+size, y:cy+size},
    {x:cx+size, y:cy+size*0.5},
    {x:cx-size, y:cy+size*0.5}
  ];

  // Rotate pyramid gently
  const cosR=Math.cos(pyramidRotation);
  const sinR=Math.sin(pyramidRotation);
  base.forEach(p=>{
    const dx=p.x-cx;
    const dz=p.y-cy;
    p.x=cx+dx*cosR - dz*sinR;
    p.y=cy+dx*sinR + dz*cosR;
  });

  // Draw pyramid sides
  pCtx.strokeStyle="rgba(0,255,255,0.7)";
  pCtx.lineWidth=2;
  base.forEach((p,i)=>{
    const next=base[(i+1)%base.length];
    pCtx.beginPath(); pCtx.moveTo(top.x,top.y); pCtx.lineTo(p.x,p.y); pCtx.lineTo(next.x,next.y); pCtx.closePath(); pCtx.stroke();
  });

  // Draw beams based on audio
  for(let i=0;i<dataArray.length;i+=10){
    const h=dataArray[i]/2;
    pCtx.strokeStyle=`hsl(${i*3},80%,60%)`;
    pCtx.beginPath(); pCtx.moveTo(cx,cy); pCtx.lineTo(cx + Math.sin(i+pyramidRotation)*h, cy - h); pCtx.stroke();
  }
}

/* ==============================
   CIRCULAR WAVEFORM HALO
============================== */
function drawWaveform(){
  requestAnimationFrame(drawWaveform);
  if(!analyser) return;
  analyser.getByteFrequencyData(dataArray);
  wCtx.clearRect(0,0,waveCanvas.width,waveCanvas.height);
  const cx=waveCanvas.width/2;
  const cy=waveCanvas.height/2;
  const radius=80;

  for(let i=0;i<dataArray.length;i++){
    const angle=(i/dataArray.length)*2*Math.PI;
    const amp=dataArray[i]/2;
    const x=cx + Math.cos(angle)*(radius+amp);
    const y=cy + Math.sin(angle)*(radius+amp);
    wCtx.fillStyle=`hsl(${i*4},80%,60%)`;
    wCtx.fillRect(x,y,3,3);
  }
}
</script>
</body>
</html>
